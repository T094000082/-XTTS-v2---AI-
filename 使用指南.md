# 讀稿機程式使用指南

## 快速開始

### ⚠️ 重要提醒：必須使用虛擬環境
本程式需要在虛擬環境中運行，直接使用 `python tts_final.py` 會出現「沒有可用的 TTS 引擎」錯誤。

### 推薦使用方法（最簡單）
```cmd
run_tts.bat "你好，歡迎使用讀稿機程式"
```

### 手動激活虛擬環境使用
```cmd
# 激活虛擬環境
.\xtts_env\Scripts\Activate.ps1

# 運行程式
python tts_final.py "你好，歡迎使用讀稿機程式"
```

### 系統要求
- Python 3.7 或更高版本
- Windows 10/11 (推薦)
- 已創建並配置 xtts_env 虛擬環境

### 首次安裝
```cmd
# 1. 創建虛擬環境
create_xtts_env.bat

# 2. 安裝依賴
setup_xtts.bat

# 3. 開始使用
run_tts.bat "測試文字"
```

## 程式版本說明

### 1. tts_final.py (推薦)
**最終穩定版**
- ✅ 穩定可靠
- ✅ 無複雜依賴
- ✅ 支援中英文
- ✅ 自動選擇最佳引擎
- ✅ 完整錯誤處理

使用方法：
```cmd
# 推薦：使用批次檔
run_tts.bat "你的文字"

# 或手動激活虛擬環境後使用
.\xtts_env\Scripts\Activate.ps1
python tts_final.py "你的文字"
python tts_final.py --help
python tts_final.py --test
python tts_final.py --info
python tts_final.py --voices
```

### 2. simple_tts.py
**簡化版**
- ✅ 極簡設計
- ✅ 快速啟動
- ⚠️ 功能較少
- ⚠️ 需要虛擬環境

使用方法：
```cmd
# 激活虛擬環境後使用
.\xtts_env\Scripts\Activate.ps1
python simple_tts.py "你的文字"
```

### 3. tts_reader.py
**進階版 (有問題)**
- ❌ XTTS v2 套件衝突
- ❌ NumPy 版本問題
- ⚠️ 不建議使用

### 4. practical_tts.py
**智能版 (有問題)**
- ❌ 套件依賴問題
- ⚠️ 暫時無法使用

## 命令行參數

### tts_final.py 參數
```cmd
python tts_final.py "文字內容"    # 基本朗讀
python tts_final.py --info       # 顯示引擎資訊
python tts_final.py --voices     # 列出可用語音
python tts_final.py --test       # 執行測試
python tts_final.py --help       # 顯示幫助
```

## 使用範例

### 1. 中文朗讀
```cmd
run_tts.bat "你好，歡迎使用讀稿機程式"
```

### 2. 英文朗讀
```cmd
run_tts.bat "Hello World, welcome to the TTS reader"
```

### 3. 數字朗讀
```cmd
run_tts.bat "1234567890"
```

### 4. 混合語言
```cmd
run_tts.bat "這是中英文混合 Hello World 測試"
```

### 5. 長文本朗讀
```cmd
run_tts.bat "這是一段比較長的文字，用來測試讀稿機程式是否能夠正確處理長文本的朗讀功能。程式會自動調整語速和音量，確保朗讀效果清晰可聽。"
```

## 程式呼叫方式

### 1. 命令行直接呼叫
```cmd
cd "f:\VS_PJ\Python\讀稿機"
# 使用推薦的批次檔
run_tts.bat "你的文字"

# 或手動激活虛擬環境
.\xtts_env\Scripts\Activate.ps1
python tts_final.py "你的文字"
```

### 2. Python 腳本中呼叫
```python
import subprocess
import sys

result = subprocess.run([
    sys.executable, "tts_final.py", "你要朗讀的文字"
], capture_output=True, text=True)

if result.returncode == 0:
    print("朗讀成功")
else:
    print("朗讀失敗")
```

### 3. 批次檔呼叫
推薦使用內建的 `run_tts.bat`：
```cmd
run_tts.bat "你好世界"
```

或創建自定義 `speak.bat`：
```batch
@echo off
cd /d "f:\VS_PJ\Python\讀稿機"
call xtts_env\Scripts\activate.bat
python tts_final.py %*
pause
```

使用：
```cmd
speak.bat "你好世界"
```

## 故障排除

### 問題 1: 沒有可用的 TTS 引擎
**症狀**: 顯示 "沒有可用的 TTS 引擎"
**原因**: 未使用虛擬環境或虛擬環境中缺少套件
**解決方案**:
```cmd
# 方法一：使用推薦的批次檔
run_tts.bat "測試文字"

# 方法二：手動激活虛擬環境
.\xtts_env\Scripts\Activate.ps1
python tts_final.py "測試文字"

# 方法三：如果虛擬環境不存在，重新創建
create_xtts_env.bat
setup_xtts.bat
```

### 問題 2: 沒有聲音
**症狀**: 程式運行但沒有聲音
**解決方案**:
1. 檢查系統音量
2. 檢查音響設備
3. 重新啟動程式

### 問題 3: 中文發音不準確
**症狀**: 中文朗讀不清楚
**解決方案**:
1. 使用 `python tts_final.py --voices` 查看可用語音
2. 確保系統有中文語音包

### 問題 4: 程式無法啟動
**症狀**: Python 錯誤
**解決方案**:
1. 檢查 Python 版本：`python --version`
2. 重新安裝套件：`pip install --upgrade pyttsx3`

## 技術細節

### 支援的 TTS 引擎
1. **pyttsx3** - 跨平台 TTS 引擎 (推薦)
2. **Windows SAPI** - Windows 內建語音合成

### 支援的語言
- 中文 (繁體/簡體)
- 英文
- 其他系統支援的語言

### 引擎選擇邏輯
1. 優先使用 pyttsx3 (品質較好)
2. 備用 Windows SAPI (系統內建)
3. 如果都不可用，顯示錯誤訊息

## 進階使用

### 自定義語音參數
程式預設設定：
- 語速: 150 (可調整)
- 音量: 0.9 (90%)

### 批次處理
創建文字檔案 `texts.txt`：
```
你好世界
Hello World
測試文字
```

批次朗讀腳本：
```python
with open('texts.txt', 'r', encoding='utf-8') as f:
    for line in f:
        if line.strip():
            subprocess.run([sys.executable, "tts_final.py", line.strip()])
```

## 開發者資訊

- **程式語言**: Python 3
- **主要依賴**: pyttsx3, pywin32
- **授權**: 開源
- **版本**: 1.0

有任何問題或建議，歡迎聯繫開發者。
